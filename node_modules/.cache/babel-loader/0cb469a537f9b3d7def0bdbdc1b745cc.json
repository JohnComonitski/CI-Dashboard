{"ast":null,"code":"import _regeneratorRuntime from\"/Users/johncomonitski/Programming Projects/Dashboard2/Dashboard/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/johncomonitski/Programming Projects/Dashboard2/Dashboard/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/johncomonitski/Programming Projects/Dashboard2/Dashboard/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect,useContext}from'react';import{faCashRegister,faChartLine}from'@fortawesome/free-solid-svg-icons';import{Col,Row,Button}from'@themesberg/react-bootstrap';import{CounterWidget,CircleChartWidget,SalesValueWidget,SalesValueWidgetPhone}from\"../../components/Widgets\";import{TransactionsTable}from\"../../components/Tables\";import{Routes}from\"../../routes\";import{UserContext}from\"../UserContext\";export default(function(props){var emptyPackage={today:{rows:[{sales:0,day:\"\",profit:0,product_id:\"\"}],period:\"\"},sales:{firstDay:\"\",lastDay:\"\",total:0,days:{sales:0,day:\"\",profit:0,product_id:\"\"}},campaigns:[],products:{}};//User\nvar _useContext=useContext(UserContext),user=_useContext.user,setUser=_useContext.setUser;//UI Widgets\nvar _useState=useState(emptyPackage.today),_useState2=_slicedToArray(_useState,2),overview=_useState2[0],setOverview=_useState2[1];var _useState3=useState(emptyPackage.sales),_useState4=_slicedToArray(_useState3,2),sales=_useState4[0],setSales=_useState4[1];var _useState5=useState(emptyPackage.campaigns),_useState6=_slicedToArray(_useState5,2),campaigns=_useState6[0],setCampaigns=_useState6[1];var _useState7=useState(emptyPackage.products),_useState8=_slicedToArray(_useState7,2),productsNames=_useState8[0],setProductsNames=_useState8[1];useEffect(function(){//Making sure we're logged in\nif(props.history.location.state===undefined&&(user.id===undefined||user.id===\"\")){props.history.push({pathname:Routes.Signin.path});}else{_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var channel_id,today,date,prevDate,data,logInPackage;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(props.history.location.state===undefined){channel_id=user.id;}else{channel_id=props.history.location.state;}//Setting log in Package\ntoday=new Date();date=formatDate(today);today.setDate(today.getDate()-6);prevDate=formatDate(today);_context.next=7;return new Promise(function(resolve,reject){var req=queryDB(prevDate,date,\"login\",channel_id);req.then(function(result){resolve({statusCode:200,body:JSON.stringify(result,null,4)});});});case 7:data=_context.sent;//Setting up user\nlogInPackage=JSON.parse(data.body);logInPackage.sales[\"firstDay\"]=prevDate;logInPackage.sales[\"lastDay\"]=date;logInPackage.today.period=date;setUser({id:props.history.location.state,name:logInPackage.client.rows[0].yt_name,img:logInPackage.client.rows[0].logo,rate:logInPackage.client.rows[0].rate,settings:logInPackage.client.rows[0],admin:logInPackage.client.rows[0].admin,clients:logInPackage.clients});//Setting up UI\nsetProductsNames(getProductNames(logInPackage.campaigns));setOverview(prepToday(logInPackage.today,productsNames));setSales(prepSales(logInPackage.sales));setCampaigns(prepCampaigns(logInPackage.campaigns,logInPackage.client.rows[0].rate));case 17:case\"end\":return _context.stop();}}},_callee);}))();}},[]);//Button Events\nfunction overviewToday(){return _overviewToday.apply(this,arguments);}function _overviewToday(){_overviewToday=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var classname,today,date,data;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0://change color\nclassname=document.getElementById(\"1\").className;classname=classname.replace(\"btn-secondary\",\"btn-primary\");document.getElementById(\"1\").className=classname;classname=document.getElementById(\"2\").className;classname=classname.replace(\"btn-primary\",\"btn-secondary\");document.getElementById(\"2\").className=classname;classname=document.getElementById(\"3\").className;classname=classname.replace(\"btn-primary\",\"btn-secondary\");document.getElementById(\"3\").className=classname;//Getting today\ntoday=new Date();date=formatDate(today);_context2.next=13;return queryDB(date,\"\",\"sales\",user.id);case 13:data=_context2.sent;data.period=\"date\";if(data.rows.length===0){setOverview(prepToday({rows:[{sales:0,day:date,profit:0,product_id:\"\"}],period:date},{}));}else{setOverview(prepToday(data,productsNames));}case 16:case\"end\":return _context2.stop();}}},_callee2);}));return _overviewToday.apply(this,arguments);}function overviewWeek(){return _overviewWeek.apply(this,arguments);}function _overviewWeek(){_overviewWeek=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){var classname,today,date,prevDate,data;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0://change color\nclassname=document.getElementById(\"1\").className;classname=classname.replace(\"btn-primary\",\"btn-secondary\");document.getElementById(\"1\").className=classname;classname=document.getElementById(\"2\").className;classname=classname.replace(\"btn-secondary\",\"btn-primary\");document.getElementById(\"2\").className=classname;classname=document.getElementById(\"3\").className;classname=classname.replace(\"btn-primary\",\"btn-secondary\");document.getElementById(\"3\").className=classname;//Getting today\ntoday=new Date();date=formatDate(today);today.setDate(today.getDate()-6);prevDate=formatDate(today);_context3.next=15;return queryDB(prevDate,date,\"sales\",user.id);case 15:data=_context3.sent;data.period=\"This week\";if(data.rows.length===0){setOverview(prepToday({rows:[{sales:0,day:date,profit:0,product_id:\"\"}],period:\"This Week\"},{}));}else{setOverview(prepToday(data,productsNames));}case 18:case\"end\":return _context3.stop();}}},_callee3);}));return _overviewWeek.apply(this,arguments);}function overviewMonth(){return _overviewMonth.apply(this,arguments);}function _overviewMonth(){_overviewMonth=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(){var classname,today,firstDay,lastDay,date,prevDate,data;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0://change color\nclassname=document.getElementById(\"1\").className;classname=classname.replace(\"btn-primary\",\"btn-secondary\");document.getElementById(\"1\").className=classname;classname=document.getElementById(\"2\").className;classname=classname.replace(\"btn-primary\",\"btn-secondary\");document.getElementById(\"2\").className=classname;classname=document.getElementById(\"3\").className;classname=classname.replace(\"btn-secondary\",\"btn-primary\");document.getElementById(\"3\").className=classname;//Getting today\ntoday=new Date();firstDay=new Date(today.getFullYear(),today.getMonth(),1);lastDay=new Date(today.getFullYear(),today.getMonth()+1,0);date=formatDate(firstDay);prevDate=formatDate(lastDay);_context4.next=16;return queryDB(date,prevDate,\"sales\",user.id);case 16:data=_context4.sent;data.period=\"This month\";if(data.rows.length===0){setOverview(prepToday({rows:[{sales:0,day:date,profit:0,product_id:\"\"}],period:\"This month\"},{}));}else{setOverview(prepToday(data,productsNames));}case 19:case\"end\":return _context4.stop();}}},_callee4);}));return _overviewMonth.apply(this,arguments);}function salesWeek(){return _salesWeek.apply(this,arguments);}function _salesWeek(){_salesWeek=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(){var classname,today,date,prevDate,data;return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0://change color\nclassname=document.getElementById(\"4\").className;classname=classname.replace(\"btn-secondary\",\"btn-primary\");document.getElementById(\"4\").className=classname;classname=document.getElementById(\"5\").className;classname=classname.replace(\"btn-primary\",\"btn-secondary\");document.getElementById(\"5\").className=classname;classname=document.getElementById(\"6\").className;classname=classname.replace(\"btn-primary\",\"btn-secondary\");document.getElementById(\"6\").className=classname;//Getting today\ntoday=new Date();date=formatDate(today);today.setDate(today.getDate()-6);prevDate=formatDate(today);_context5.next=15;return queryDB(prevDate,date,\"sales\",user.id);case 15:data=_context5.sent;if(data.rows.length===0){setSales(prepSales({firstDay:\"\",lastDay:\"\",rows:[{sales:0,day:date,profit:0,product_id:\"\"}]}));}else{data[\"firstDay\"]=prevDate;data[\"lastDay\"]=date;setSales(prepSales(data));}case 17:case\"end\":return _context5.stop();}}},_callee5);}));return _salesWeek.apply(this,arguments);}function salesMonth(){return _salesMonth.apply(this,arguments);}function _salesMonth(){_salesMonth=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee6(){var classname,today,firstDay,lastDay,date,prevDate,data;return _regeneratorRuntime.wrap(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0://change color\nclassname=document.getElementById(\"4\").className;classname=classname.replace(\"btn-primary\",\"btn-secondary\");document.getElementById(\"4\").className=classname;classname=document.getElementById(\"5\").className;classname=classname.replace(\"btn-secondary\",\"btn-primary\");document.getElementById(\"5\").className=classname;classname=document.getElementById(\"6\").className;classname=classname.replace(\"btn-primary\",\"btn-secondary\");document.getElementById(\"6\").className=classname;//Getting today\ntoday=new Date();firstDay=new Date(today.getFullYear(),today.getMonth(),1);lastDay=new Date(today.getFullYear(),today.getMonth()+1,0);date=formatDate(firstDay);prevDate=formatDate(lastDay);_context6.next=16;return queryDB(date,prevDate,\"sales\",user.id);case 16:data=_context6.sent;if(data.rows.length===0){setSales(prepSales({firstDay:\"\",lastDay:\"\",rows:[{sales:0,day:date,profit:0,product_id:\"\"}]}));}else{data[\"firstDay\"]=date;data[\"lastDay\"]=prevDate;setSales(prepSales(data));}case 18:case\"end\":return _context6.stop();}}},_callee6);}));return _salesMonth.apply(this,arguments);}function salesCustom(_x,_x2){return _salesCustom.apply(this,arguments);}function _salesCustom(){_salesCustom=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee7(e,range){var classname,start,end,date,prevDate,data;return _regeneratorRuntime.wrap(function _callee7$(_context7){while(1){switch(_context7.prev=_context7.next){case 0://console.log(range)\n//change color\nclassname=document.getElementById(\"4\").className;classname=classname.replace(\"btn-primary\",\"btn-secondary\");document.getElementById(\"4\").className=classname;classname=document.getElementById(\"5\").className;classname=classname.replace(\"btn-secondary\",\"btn-secondary\");document.getElementById(\"5\").className=classname;classname=document.getElementById(\"6\").className;classname=classname.replace(\"btn-secondary\",\"btn-primary\");document.getElementById(\"6\").className=classname;start=range.startDate;end=range.endDate;date=formatDate(new Date(start));prevDate=formatDate(new Date(end));_context7.next=15;return queryDB(date,prevDate,\"sales\",user.id);case 15:data=_context7.sent;if(data.rows.length===0){setSales(prepSales({firstDay:\"\",lastDay:\"\",rows:[{sales:0,day:date,profit:0,product_id:\"\"}]}));}else{data[\"firstDay\"]=date;data[\"lastDay\"]=prevDate;setSales(prepSales(data));}case 17:case\"end\":return _context7.stop();}}},_callee7);}));return _salesCustom.apply(this,arguments);}return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center py-4\"},/*#__PURE__*/React.createElement(\"h2\",null,\" Sales Overview\"),/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex ms-auto\"},/*#__PURE__*/React.createElement(Button,{id:\"1\",variant:\"primary\",size:\"sm\",className:\"me-2\",onClick:overviewToday},\"Today\"),/*#__PURE__*/React.createElement(Button,{id:\"2\",variant:\"secondary\",size:\"sm\",className:\"me-2\",onClick:overviewWeek},\"This Week\"),/*#__PURE__*/React.createElement(Button,{id:\"3\",variant:\"secondary\",size:\"sm\",className:\"me-3\",onClick:overviewMonth},\"This Month\"))),/*#__PURE__*/React.createElement(Row,{className:\"justify-content-md-center\"},/*#__PURE__*/React.createElement(Col,{xs:12,sm:6,xl:4,className:\"mb-4\"},/*#__PURE__*/React.createElement(CounterWidget,{category:\"Sales\",title:overview.sales,period:overview.period,percentage:0,icon:faChartLine,iconColor:\"shape-secondary\"})),/*#__PURE__*/React.createElement(Col,{xs:12,sm:6,xl:4,className:\"mb-4\"},/*#__PURE__*/React.createElement(CounterWidget,{category:\"Profit\",title:(parseInt(overview.profit)*user.rate).toFixed(2),period:overview.period,percentage:28.4,icon:faCashRegister,iconColor:\"shape-tertiary\"})),/*#__PURE__*/React.createElement(Col,{xs:12,sm:6,xl:4,className:\"mb-4\"},/*#__PURE__*/React.createElement(CircleChartWidget,{title:\"Products\",data:overview.products})),/*#__PURE__*/React.createElement(Col,{xs:12,className:\"mb-4 d-none d-sm-block\"},/*#__PURE__*/React.createElement(SalesValueWidget,{title:\"Sales Profit\",value:sales.total*user.rate,data:sales.days,custom:salesCustom,week:salesWeek,month:salesMonth})),/*#__PURE__*/React.createElement(Col,{xs:12,className:\"mb-4 d-sm-none\"},/*#__PURE__*/React.createElement(SalesValueWidgetPhone,{title:\"Sales Value\",value:sales.total*user.rate,data:sales.days,custom:salesCustom,week:salesWeek,month:salesMonth}))),/*#__PURE__*/React.createElement(Row,null,/*#__PURE__*/React.createElement(Col,{xs:12,xl:12,className:\"mb-4\"},/*#__PURE__*/React.createElement(Row,null,/*#__PURE__*/React.createElement(TransactionsTable,{data:campaigns})))));});function prepToday(data,productsNames){var products={};var tmp={\"sales\":0,\"profit\":0,\"products\":[],\"date\":formatDate(new Date())};for(var i=0;i<data.rows.length;i++){tmp[\"sales\"]=tmp[\"sales\"]+data.rows[i].sales;tmp[\"profit\"]=tmp[\"profit\"]+data.rows[i].profit;if(products[data.rows[i].product_id]===undefined){products[data.rows[i].product_id]=data.rows[i].sales;}else{products[data.rows[i].product_id]=data.rows[i].sales+products[data.rows[i].product_id];}}if(tmp.sales!==0){i=0;for(var product in products){tmp.products.push({\"id\":i+1,\"label\":productsNames[product],\"value\":products[product]});i=i+1;}}tmp.period=data.period;return tmp;}function prepSales(data){var tmp={\"total\":0,\"days\":{\"labels\":[],\"series\":[]}};var days={};//Create days data structure\nif(data.firstDay!==\"\"){var start=new Date(data.firstDay);start.setDate(start.getDate()+1);var end=new Date(data.lastDay);end.setDate(end.getDate()+1);var loop=new Date(start);while(loop<=end){var date=formatDate(loop);date=date.substring(5,7)+\"/\"+date.substring(8,10);days[date]=0;var newDate=loop.setDate(loop.getDate()+1);loop=new Date(newDate);}}//fill in dates\nfor(var i=0;i<data.rows.length;i++){tmp.total=tmp.total+data.rows[i].profit;date=data.rows[i].day.substring(5,7)+\"/\"+data.rows[i].day.substring(8,10);if(days[date]===undefined){days[date]=data.rows[i].sales;}else{days[date]=days[date]+data.rows[i].sales;}}var series=[];for(var day in days){tmp.days.labels.push(day);series.push(days[day]);}tmp.days.series.push(series);return tmp;}function prepCampaigns(data,rate){var tmp=[];for(var i=0;i<data.rows.length;i++){var row={\"products\":data.rows[i].img_url,\"day\":data.rows[i].start_date.substring(0,10),\"sales\":data.rows[i].sales,\"profit\":(data.rows[i].profit*rate).toFixed(2)};tmp.push(row);}return tmp;}function getProductNames(data){var tmp={};for(var i=0;i<data.rows.length;i++){tmp[data.rows[i].product_id]=data.rows[i].short_name;}return tmp;}function queryDB(_x3,_x4,_x5,_x6){return _queryDB.apply(this,arguments);}function _queryDB(){_queryDB=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee8(start,end,q,id){var url,Response,tmp;return _regeneratorRuntime.wrap(function _callee8$(_context8){while(1){switch(_context8.prev=_context8.next){case 0://Building API Call\nurl=\"https://d7rc7vsgld.execute-api.us-west-2.amazonaws.com/dev/q?id=\"+id;if(q!==\"\"){url+=\"&q=\"+q;}if(start!==\"\"){url+=\"&start=\"+start;}if(end!==\"\"){url+=\"&end=\"+end;}//Making Call\n_context8.next=6;return new Promise(function(resolve,reject){var req=fetch(url,{method:'GET',// *GET, POST, PUT, DELETE, etc.\nmode:'cors',// no-cors, *cors, same-origin\ncache:'no-cache',// *default, no-cache, reload, force-cache, only-if-cached\ncredentials:'same-origin',// include, *same-origin, omit\nheaders:{'Content-Type':'text/plain'// 'Content-Type': 'application/x-www-form-urlencoded',\n},redirect:'follow',// manual, *follow, error\nreferrerPolicy:'no-referrer'// no-referrer, *no-referrer-when-downgrade, origin, origin-when-cross-origin, same-origin, strict-origin, strict-origin-when-cross-origin, unsafe-url\n});req.then(function(result){var res=result.json();res.then(function(tmp){resolve({statusCode:200,body:JSON.stringify(tmp,null,4)});});});});case 6:Response=_context8.sent;tmp=JSON.parse(Response.body);return _context8.abrupt(\"return\",tmp);case 9:case\"end\":return _context8.stop();}}},_callee8);}));return _queryDB.apply(this,arguments);}function formatDate(day){var date;if(day.getMonth()<9){date=day.getFullYear()+'-0'+(day.getMonth()+1);}else{date=day.getFullYear()+'-'+(day.getMonth()+1);}if(day.getDate()<9){date=date+'-0'+day.getDate();}else{date=date+'-'+day.getDate();}return date;}","map":{"version":3,"sources":["/Users/johncomonitski/Programming Projects/Dashboard2/Dashboard/src/pages/dashboard/DashboardOverview.js"],"names":["React","useState","useEffect","useContext","faCashRegister","faChartLine","Col","Row","Button","CounterWidget","CircleChartWidget","SalesValueWidget","SalesValueWidgetPhone","TransactionsTable","Routes","UserContext","props","emptyPackage","today","rows","sales","day","profit","product_id","period","firstDay","lastDay","total","days","campaigns","products","user","setUser","overview","setOverview","setSales","setCampaigns","productsNames","setProductsNames","history","location","state","undefined","id","push","pathname","Signin","path","channel_id","Date","date","formatDate","setDate","getDate","prevDate","Promise","resolve","reject","req","queryDB","then","result","statusCode","body","JSON","stringify","data","logInPackage","parse","name","client","yt_name","img","logo","rate","settings","admin","clients","getProductNames","prepToday","prepSales","prepCampaigns","overviewToday","classname","document","getElementById","className","replace","length","overviewWeek","overviewMonth","getFullYear","getMonth","salesWeek","salesMonth","salesCustom","e","range","start","startDate","end","endDate","parseInt","toFixed","tmp","i","product","loop","substring","newDate","series","labels","row","img_url","start_date","short_name","q","url","fetch","method","mode","cache","credentials","headers","redirect","referrerPolicy","res","json","Response"],"mappings":"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","sourcesContent":["\nimport React, { useState, useEffect, useContext } from 'react';\nimport { faCashRegister, faChartLine } from '@fortawesome/free-solid-svg-icons';\nimport { Col, Row, Button } from '@themesberg/react-bootstrap';\nimport { CounterWidget, CircleChartWidget, SalesValueWidget, SalesValueWidgetPhone } from \"../../components/Widgets\";\nimport { TransactionsTable } from \"../../components/Tables\";\nimport { Routes } from \"../../routes\";\nimport { UserContext } from \"../UserContext\";\n\nexport default (props) => {\n\n  const emptyPackage = {\n    today: {rows:[{sales:0, day:\"\", profit:0, product_id:\"\"}], period:\"\"},\n    sales: {firstDay: \"\", lastDay: \"\", total: 0,days:{sales:0, day:\"\", profit:0, product_id:\"\"}},\n    campaigns: [],\n    products:{}\n  }\n\n  //User\n  const {user, setUser} = useContext(UserContext);\n  //UI Widgets\n  const [overview, setOverview] = useState(emptyPackage.today);\n  const [sales, setSales] = useState(emptyPackage.sales);\n  const [campaigns, setCampaigns] = useState(emptyPackage.campaigns);\n  const [productsNames, setProductsNames] = useState(emptyPackage.products);\n\n  useEffect(() => {\n    //Making sure we're logged in\n    if((props.history.location.state === undefined) && (user.id === undefined || user.id===\"\")){\n      props.history.push({pathname: Routes.Signin.path});\n    }\n    else{\n      (async () => {\n        var channel_id;\n        if(props.history.location.state === undefined){\n          channel_id = user.id\n        }\n        else{\n          channel_id = props.history.location.state;\n        }\n        //Setting log in Package\n        var today = new Date();\n        var date = formatDate(today);\n        today.setDate(today.getDate() - 6)\n        var prevDate = formatDate(today);\n        var data = await new Promise((resolve, reject) => {\n          var req = queryDB(prevDate, date, \"login\", channel_id);\n          req.then((result) => {\n            resolve({\n              statusCode: 200,\n              body: JSON.stringify(result, null, 4)\n            });\n          });\n        });\n        //Setting up user\n        var logInPackage = JSON.parse(data.body)\n        logInPackage.sales[\"firstDay\"] = prevDate\n        logInPackage.sales[\"lastDay\"] = date\n        logInPackage.today.period = date\n        setUser({id:props.history.location.state, name:logInPackage.client.rows[0].yt_name, img: logInPackage.client.rows[0].logo, rate: logInPackage.client.rows[0].rate, settings:logInPackage.client.rows[0], admin: logInPackage.client.rows[0].admin, clients: logInPackage.clients})\n        //Setting up UI\n        setProductsNames(getProductNames(logInPackage.campaigns))\n        setOverview(prepToday(logInPackage.today, productsNames));\n        setSales(prepSales(logInPackage.sales));\n        setCampaigns(prepCampaigns(logInPackage.campaigns,logInPackage.client.rows[0].rate));\n\n      })()\n    }\n  },[])\n\n\n  //Button Events\n  async function overviewToday(){\n    //change color\n    var classname = document.getElementById(\"1\").className;\n    classname = classname.replace(\"btn-secondary\",\"btn-primary\");\n    document.getElementById(\"1\").className = classname;\n\n    classname = document.getElementById(\"2\").className;\n    classname = classname.replace(\"btn-primary\",\"btn-secondary\");\n    document.getElementById(\"2\").className = classname;\n\n    classname = document.getElementById(\"3\").className;\n    classname = classname.replace(\"btn-primary\",\"btn-secondary\");\n    document.getElementById(\"3\").className = classname;\n\n    //Getting today\n    var today = new Date();\n    var date = formatDate(today);\n\n    var data = await queryDB(date, \"\", \"sales\", user.id);\n    data.period = \"date\";\n    if(data.rows.length === 0){\n      setOverview(prepToday({rows:[{sales:0, day:date, profit:0, product_id:\"\"}],period: date}, {}));\n    }\n    else{\n      setOverview(prepToday(data, productsNames))\n    }\n  }\n  async function overviewWeek(){\n    //change color\n    var classname = document.getElementById(\"1\").className;\n    classname = classname.replace(\"btn-primary\",\"btn-secondary\");\n    document.getElementById(\"1\").className = classname;\n\n    classname = document.getElementById(\"2\").className;\n    classname = classname.replace(\"btn-secondary\",\"btn-primary\");\n    document.getElementById(\"2\").className = classname;\n\n    classname = document.getElementById(\"3\").className;\n    classname = classname.replace(\"btn-primary\",\"btn-secondary\");\n    document.getElementById(\"3\").className = classname;\n\n    //Getting today\n    var today = new Date();\n    var date = formatDate(today);\n    today.setDate(today.getDate() - 6)\n    var prevDate = formatDate(today);\n\n    var data = await queryDB(prevDate, date, \"sales\", user.id);\n    data.period = \"This week\"\n    if(data.rows.length === 0){\n      setOverview(prepToday({rows:[{sales:0, day:date, profit:0, product_id:\"\"}], period:\"This Week\"},{}));\n    }\n    else{\n      setOverview(prepToday(data, productsNames))\n    }\n  }\n  async function overviewMonth(){\n    //change color\n    var classname = document.getElementById(\"1\").className;\n    classname = classname.replace(\"btn-primary\",\"btn-secondary\");\n    document.getElementById(\"1\").className = classname;\n\n    classname = document.getElementById(\"2\").className;\n    classname = classname.replace(\"btn-primary\",\"btn-secondary\");\n    document.getElementById(\"2\").className = classname;\n\n    classname = document.getElementById(\"3\").className;\n    classname = classname.replace(\"btn-secondary\",\"btn-primary\");\n    document.getElementById(\"3\").className = classname;\n\n    //Getting today\n    var today = new Date();\n    var firstDay = new Date(today.getFullYear(), today.getMonth(), 1);\n    var lastDay = new Date(today.getFullYear(), today.getMonth() + 1, 0);\n    var date = formatDate(firstDay);\n    var prevDate = formatDate(lastDay);\n\n    var data = await queryDB(date, prevDate, \"sales\", user.id);\n    data.period = \"This month\"\n    if(data.rows.length === 0){\n      setOverview(prepToday({rows:[{sales:0, day:date, profit:0, product_id:\"\"}],period:\"This month\"},{}));\n    }\n    else{\n      setOverview(prepToday(data, productsNames))\n    }\n  }\n  async function salesWeek(){\n    //change color\n    var classname = document.getElementById(\"4\").className;\n    classname = classname.replace(\"btn-secondary\",\"btn-primary\");\n    document.getElementById(\"4\").className = classname;\n\n    classname = document.getElementById(\"5\").className;\n    classname = classname.replace(\"btn-primary\",\"btn-secondary\");\n    document.getElementById(\"5\").className = classname;\n\n    classname = document.getElementById(\"6\").className;\n    classname = classname.replace(\"btn-primary\",\"btn-secondary\");\n    document.getElementById(\"6\").className = classname;\n\n    //Getting today\n    var today = new Date();\n    var date = formatDate(today);\n    today.setDate(today.getDate() - 6)\n    var prevDate = formatDate(today);\n\n    var data = await queryDB(prevDate, date, \"sales\", user.id);\n    if(data.rows.length === 0){\n      setSales(prepSales({firstDay:\"\", lastDay:\"\", rows:[{sales:0, day:date, profit:0, product_id:\"\"}]}));\n    }\n    else{\n      data[\"firstDay\"] = prevDate;\n      data[\"lastDay\"] = date;\n      setSales(prepSales(data))\n    }\n  }\n  async function salesMonth(){\n    //change color\n    var classname = document.getElementById(\"4\").className;\n    classname = classname.replace(\"btn-primary\",\"btn-secondary\");\n    document.getElementById(\"4\").className = classname;\n\n    classname = document.getElementById(\"5\").className;\n    classname = classname.replace(\"btn-secondary\",\"btn-primary\");\n    document.getElementById(\"5\").className = classname;\n\n    classname = document.getElementById(\"6\").className;\n    classname = classname.replace(\"btn-primary\",\"btn-secondary\");\n    document.getElementById(\"6\").className = classname;\n\n    //Getting today\n    var today = new Date();\n    var firstDay = new Date(today.getFullYear(), today.getMonth(), 1);\n    var lastDay = new Date(today.getFullYear(), today.getMonth() + 1, 0);\n    var date = formatDate(firstDay);\n    var prevDate = formatDate(lastDay);\n\n    var data = await queryDB(date, prevDate, \"sales\", user.id);\n    if(data.rows.length === 0){\n      setSales(prepSales({firstDay:\"\", lastDay:\"\", rows:[{sales:0, day:date, profit:0, product_id:\"\"}]}));\n    }\n    else{\n      data[\"firstDay\"] = date;\n      data[\"lastDay\"] = prevDate;\n      setSales(prepSales(data))\n    }\n  }\n  async function salesCustom(e, range){\n    //console.log(range)\n    //change color\n    var classname = document.getElementById(\"4\").className;\n    classname = classname.replace(\"btn-primary\",\"btn-secondary\");\n    document.getElementById(\"4\").className = classname;\n\n    classname = document.getElementById(\"5\").className;\n    classname = classname.replace(\"btn-secondary\",\"btn-secondary\");\n    document.getElementById(\"5\").className = classname;\n\n    classname = document.getElementById(\"6\").className;\n    classname = classname.replace(\"btn-secondary\",\"btn-primary\");\n    document.getElementById(\"6\").className = classname;\n\n    var start = range.startDate;\n    var end = range.endDate;\n    var date = formatDate(new Date(start));\n    var prevDate = formatDate(new Date(end));\n\n    var data = await queryDB(date, prevDate, \"sales\", user.id);\n    if(data.rows.length === 0){\n      setSales(prepSales({firstDay:\"\", lastDay:\"\", rows:[{sales:0, day:date, profit:0, product_id:\"\"}]}));\n    }\n    else{\n      data[\"firstDay\"] = date;\n      data[\"lastDay\"] = prevDate;\n      setSales(prepSales(data))\n    }\n  }\n\n  return (\n    <>\n      <div className=\"d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center py-4\">\n        <h2> Sales Overview</h2>\n\n        <div className=\"d-flex ms-auto\">\n            <Button id=\"1\" variant=\"primary\" size=\"sm\" className=\"me-2\" onClick={overviewToday}>Today</Button>\n            <Button id=\"2\" variant=\"secondary\" size=\"sm\" className=\"me-2\" onClick={overviewWeek}>This Week</Button>\n            <Button id=\"3\" variant=\"secondary\" size=\"sm\" className=\"me-3\" onClick={overviewMonth}>This Month</Button>\n        </div>\n      </div>\n\n      <Row className=\"justify-content-md-center\">\n      <Col xs={12} sm={6} xl={4} className=\"mb-4\">\n          <CounterWidget\n            category=\"Sales\"\n            title={overview.sales}\n            period={overview.period}\n            percentage={0}\n            icon={faChartLine}\n            iconColor=\"shape-secondary\"\n          />\n        </Col>\n\n        <Col xs={12} sm={6} xl={4} className=\"mb-4\">\n          <CounterWidget\n            category=\"Profit\"\n            title={(parseInt(overview.profit) * user.rate).toFixed(2)}\n            period={overview.period}\n            percentage={28.4}\n            icon={faCashRegister}\n            iconColor=\"shape-tertiary\"\n          />\n        </Col>\n\n        <Col xs={12} sm={6} xl={4} className=\"mb-4\">\n          <CircleChartWidget\n            title=\"Products\"\n            data={overview.products} />\n        </Col>\n\n        <Col xs={12} className=\"mb-4 d-none d-sm-block\">\n          <SalesValueWidget\n            title=\"Sales Profit\"\n            value={sales.total * user.rate}\n            data={sales.days}\n            custom={salesCustom}\n            week={salesWeek}\n            month={salesMonth}\n          />\n        </Col>\n        <Col xs={12} className=\"mb-4 d-sm-none\">\n          <SalesValueWidgetPhone\n            title=\"Sales Value\"\n            value={sales.total * user.rate}\n            data={sales.days}\n            custom={salesCustom}\n            week={salesWeek}\n            month={salesMonth}\n          />\n        </Col>\n      </Row>\n\n      <Row>\n        <Col xs={12} xl={12} className=\"mb-4\">\n          <Row>\n            <TransactionsTable data={campaigns} />\n          </Row>\n        </Col>\n      </Row>\n    </>\n  );\n};\n\nfunction prepToday(data, productsNames){\n  var products = {};\n  var tmp = {\"sales\": 0, \"profit\": 0, \"products\":[],\"date\":formatDate(new Date())};\n  for(var i = 0; i < data.rows.length; i++){\n    tmp[\"sales\"] = tmp[\"sales\"] + data.rows[i].sales;\n    tmp[\"profit\"] = tmp[\"profit\"] + data.rows[i].profit;\n\n    if(products[data.rows[i].product_id]===undefined){\n      products[data.rows[i].product_id] = data.rows[i].sales;\n    }\n    else{\n      products[data.rows[i].product_id] = data.rows[i].sales + products[data.rows[i].product_id];\n    }\n  }\n  if(tmp.sales !== 0){\n    i = 0;\n    for(const product in products){\n      tmp.products.push({\"id\": i+1, \"label\": productsNames[product], \"value\": products[product]})\n      i = i+1;\n    }\n  }\n\n  tmp.period = data.period;\n  return tmp;\n}\n\nfunction prepSales(data){\n  var tmp = {\"total\": 0, \"days\": {\"labels\" :[], \"series\": []}};\n  var days = {};\n\n  //Create days data structure\n  if(data.firstDay !== \"\"){\n    var start = new Date(data.firstDay);\n    start.setDate(start.getDate() +1);\n    var end = new Date(data.lastDay);\n    end.setDate(end.getDate() +1);\n\n    var loop = new Date(start);\n    while(loop <= end){\n       var date = formatDate(loop);\n       date = date.substring(5,7) + \"/\" + date.substring(8,10)\n       days[date] = 0;\n       var newDate = loop.setDate(loop.getDate() + 1);\n       loop = new Date(newDate);\n    }\n  }\n\n  //fill in dates\n  for(var i = 0; i < data.rows.length; i++){\n    tmp.total = tmp.total + data.rows[i].profit\n    date = data.rows[i].day.substring(5,7) + \"/\" + data.rows[i].day.substring(8,10);\n    if(days[date] === undefined){\n      days[date] = data.rows[i].sales;\n    }\n    else{\n      days[date] = days[date] + data.rows[i].sales;\n    }\n  }\n\n  var series = [];\n  for(const day in days){\n    tmp.days.labels.push(day);\n    series.push(days[day]);\n  }\n  tmp.days.series.push(series);\n  return tmp;\n}\n\nfunction prepCampaigns(data, rate){\n  var tmp = [];\n  for(var i = 0; i < data.rows.length; i++){\n    var row = {\"products\": data.rows[i].img_url, \"day\": data.rows[i].start_date.substring(0,10), \"sales\": data.rows[i].sales, \"profit\": (data.rows[i].profit * rate).toFixed(2)};\n    tmp.push(row);\n  }\n\n  return tmp;\n}\n\nfunction getProductNames(data){\n  var tmp = {}\n  for(var i = 0; i < data.rows.length; i++){\n    tmp[data.rows[i].product_id] = data.rows[i].short_name\n  }\n  return tmp;\n}\n\nasync function queryDB(start, end, q, id){\n    //Building API Call\n    var url = \"https://d7rc7vsgld.execute-api.us-west-2.amazonaws.com/dev/q?id=\" + id;\n    if(q !== \"\"){\n      url += \"&q=\"+q\n    }\n    if(start !== \"\"){\n      url += \"&start=\"+start\n    }\n    if(end !== \"\"){\n      url += \"&end=\"+end\n    }\n\n    //Making Call\n    const Response = await new Promise((resolve, reject) => {\n  \tvar req = fetch(url, {\n  \t\tmethod: 'GET', // *GET, POST, PUT, DELETE, etc.\n  \t\tmode: 'cors', // no-cors, *cors, same-origin\n  \t\tcache: 'no-cache', // *default, no-cache, reload, force-cache, only-if-cached\n  \t\tcredentials: 'same-origin', // include, *same-origin, omit\n  \t\theaders: {\n  \t\t  'Content-Type': 'text/plain',\n  \t\t  // 'Content-Type': 'application/x-www-form-urlencoded',\n  \t\t},\n  \t\tredirect: 'follow', // manual, *follow, error\n  \t\treferrerPolicy: 'no-referrer' // no-referrer, *no-referrer-when-downgrade, origin, origin-when-cross-origin, same-origin, strict-origin, strict-origin-when-cross-origin, unsafe-url\n  \t});\n  \treq.then((result) => {\n  \t    var res = result.json()\n  \t    res.then((tmp) => {\n  \t        resolve({\n      \t\t    statusCode: 200,\n      \t\t    body: JSON.stringify(tmp, null, 4)\n      \t    });\n  \t    });\n  \t});\n    });\n    var tmp = (JSON.parse(Response.body));\n    return tmp;\n}\n\nfunction formatDate(day){\n  var date;\n  if(day.getMonth() < 9){\n    date = day.getFullYear()+'-0'+(day.getMonth()+1)\n  }\n  else{\n    date = day.getFullYear()+'-'+(day.getMonth()+1)\n  }\n  if(day.getDate() < 9){\n    date = date +'-0'+day.getDate();\n  }\n  else{\n    date = date +'-'+day.getDate();\n  }\n\n  return date;\n}\n"]},"metadata":{},"sourceType":"module"}