{"ast":null,"code":"var _jsxFileName = \"/Users/johncomonitski/Programming Projects/Dashboard2/Dashboard/src/pages/StreamAlerts.js\";\nimport React, { useState, useEffect, useContext } from 'react';\nimport { faCashRegister, faChartLine } from '@fortawesome/free-solid-svg-icons';\nimport { Col, Row, Card, Form, Button, Dropdown, ButtonGroup, InputGroup } from '@themesberg/react-bootstrap';\nimport { CounterWidget, CircleChartWidget, BarChartWidget, ProductsWidget, ProgressTrackWidget, RankingWidget, SalesValueWidget, SalesValueWidgetPhone, AcquisitionWidget } from \"../components/Widgets\";\nimport { PageVisitsTable, TransactionsTable } from \"../components/Tables\";\nimport { UserContext } from \"./UserContext\";\nexport default (props => {\n  const emptyPackage = {\n    today: {\n      rows: [{\n        sales: 0,\n        day: \"\",\n        profit: 0,\n        product_id: \"\"\n      }]\n    },\n    sales: {\n      firstDay: \"\",\n      lastDay: \"\",\n      total: 0,\n      rows: [{\n        sales: 0,\n        day: \"\",\n        profit: 0,\n        product_id: \"\"\n      }, {\n        sales: 0,\n        day: \"\",\n        profit: 0,\n        product_id: \"\"\n      }]\n    },\n    campaigns: [[]],\n    products: {}\n  }; //User\n\n  const {\n    user,\n    setUser\n  } = useContext(UserContext); //UI Widgets\n\n  const [overview, setOverview] = useState(emptyPackage.today);\n  const [sales, setSales] = useState(emptyPackage.sales);\n  const [campaigns, setCampaigns] = useState(emptyPackage.campaigns);\n  const [productsNames, setProductsNames] = useState(emptyPackage.products);\n  useEffect(() => {\n    (async () => {\n      //Setting log in Package\n      var data = await new Promise((resolve, reject) => {\n        var req = queryDB(\"2020-09-10\", \"2020-09-16\", \"login\", props.history.location.state);\n        req.then(result => {\n          resolve({\n            statusCode: 200,\n            body: JSON.stringify(result, null, 4)\n          });\n        });\n      }); //Setting up user\n\n      var logInPackage = JSON.parse(data.body);\n      setUser({\n        id: props.history.location.state,\n        name: logInPackage.client.rows[0].yt_name,\n        img: logInPackage.client.rows[0].logo,\n        rate: logInPackage.client.rows[0].rate,\n        settings: logInPackage.client.rows[0]\n      }); //Setting up UI\n\n      setProductsNames(getProductNames(logInPackage.campaigns));\n      setOverview(prepToday(logInPackage.today, productsNames));\n      logInPackage.sales[\"firstDay\"] = logInPackage.sales.rows[0].day.substring(0, 10);\n      logInPackage.sales[\"lastDay\"] = logInPackage.sales.rows[logInPackage.sales.rows.length - 1].day.substring(0, 10);\n      setSales(prepSales(logInPackage.sales));\n      setCampaigns(prepCampaigns(logInPackage.campaigns, logInPackage.client.rows[0].rate)); //Setting up Sales Widget Controls\n\n      document.getElementById(\"4\").addEventListener(\"click\", salesWeek);\n      document.getElementById(\"5\").addEventListener(\"click\", salesMonth);\n    })();\n  }, []); //Button Events\n\n  async function overviewToday() {\n    //change color\n    var classname = document.getElementById(\"1\").className;\n    classname = classname.replace(\"btn-secondary\", \"btn-primary\");\n    document.getElementById(\"1\").className = classname;\n    classname = document.getElementById(\"2\").className;\n    classname = classname.replace(\"btn-primary\", \"btn-secondary\");\n    document.getElementById(\"2\").className = classname;\n    classname = document.getElementById(\"3\").className;\n    classname = classname.replace(\"btn-primary\", \"btn-secondary\");\n    document.getElementById(\"3\").className = classname; //Getting today\n\n    var today = new Date();\n    var date = formatDate(today);\n    var data = await queryDB(date, \"\", \"sales\", user.id);\n    console.log(\"hi\");\n\n    if (data.rows.length == 0) {\n      console.log(\"poop\");\n      setOverview(prepToday({\n        rows: [{\n          sales: 0,\n          day: date,\n          profit: 0,\n          product_id: \"\"\n        }]\n      }, {}));\n    } else {\n      console.log(\"tits\");\n      setOverview(prepToday(data, productsNames));\n    }\n  }\n\n  async function overviewWeek() {\n    //change color\n    var classname = document.getElementById(\"1\").className;\n    classname = classname.replace(\"btn-primary\", \"btn-secondary\");\n    document.getElementById(\"1\").className = classname;\n    classname = document.getElementById(\"2\").className;\n    classname = classname.replace(\"btn-secondary\", \"btn-primary\");\n    document.getElementById(\"2\").className = classname;\n    classname = document.getElementById(\"3\").className;\n    classname = classname.replace(\"btn-primary\", \"btn-secondary\");\n    document.getElementById(\"3\").className = classname; //Getting today\n\n    var today = new Date();\n    var date = formatDate(today);\n    today.setDate(today.getDate() - 6);\n    var prevDate = formatDate(today);\n    var data = await queryDB(prevDate, date, \"sales\", user.id);\n\n    if (data.rows.length == 0) {\n      setOverview(prepToday({\n        rows: [{\n          sales: 0,\n          day: date,\n          profit: 0,\n          product_id: \"\"\n        }]\n      }, {}));\n    } else {\n      setOverview(prepToday(data, productsNames));\n    }\n  }\n\n  async function overviewMonth() {\n    //change color\n    var classname = document.getElementById(\"1\").className;\n    classname = classname.replace(\"btn-primary\", \"btn-secondary\");\n    document.getElementById(\"1\").className = classname;\n    classname = document.getElementById(\"2\").className;\n    classname = classname.replace(\"btn-primary\", \"btn-secondary\");\n    document.getElementById(\"2\").className = classname;\n    classname = document.getElementById(\"3\").className;\n    classname = classname.replace(\"btn-secondary\", \"btn-primary\");\n    document.getElementById(\"3\").className = classname; //Getting today\n\n    var today = new Date();\n    var firstDay = new Date(today.getFullYear(), today.getMonth(), 1);\n    var lastDay = new Date(today.getFullYear(), today.getMonth() + 1, 0);\n    var date = formatDate(firstDay);\n    var prevDate = formatDate(lastDay);\n    console.log(date, prevDate);\n    var data = await queryDB(date, prevDate, \"sales\", user.id);\n\n    if (data.rows.length == 0) {\n      setOverview(prepToday({\n        rows: [{\n          sales: 0,\n          day: date,\n          profit: 0,\n          product_id: \"\"\n        }]\n      }, {}));\n    } else {\n      setOverview(prepToday(data, productsNames));\n    }\n  }\n\n  async function salesWeek() {\n    //change color\n    var classname = document.getElementById(\"4\").className;\n    classname = classname.replace(\"btn-secondary\", \"btn-primary\");\n    document.getElementById(\"4\").className = classname;\n    var classname = document.getElementById(\"5\").className;\n    classname = classname.replace(\"btn-primary\", \"btn-secondary\");\n    document.getElementById(\"5\").className = classname; //Getting today\n\n    var today = new Date();\n    var date = formatDate(today);\n    today.setDate(today.getDate() - 6);\n    var prevDate = formatDate(today);\n    var data = await queryDB(prevDate, date, \"sales\", user.id);\n    console.log(data);\n\n    if (data.rows.length == 0) {\n      setSales(prepSales({\n        firstDay: \"\",\n        lastDay: \"\",\n        rows: [{\n          sales: 0,\n          day: date,\n          profit: 0,\n          product_id: \"\"\n        }]\n      }));\n    } else {\n      data[\"firstDay\"] = prevDate;\n      data[\"lastDay\"] = date;\n      setSales(prepSales(data));\n    }\n  }\n\n  async function salesMonth() {\n    //change color\n    var classname = document.getElementById(\"4\").className;\n    classname = classname.replace(\"btn-primary\", \"btn-secondary\");\n    document.getElementById(\"4\").className = classname;\n    var classname = document.getElementById(\"5\").className;\n    classname = classname.replace(\"btn-secondary\", \"btn-primary\");\n    document.getElementById(\"5\").className = classname; //Getting today\n\n    var today = new Date();\n    var firstDay = new Date(today.getFullYear(), today.getMonth(), 1);\n    var lastDay = new Date(today.getFullYear(), today.getMonth() + 1, 0);\n    var date = formatDate(firstDay);\n    var prevDate = formatDate(lastDay);\n    var data = await queryDB(date, prevDate, \"sales\", user.id);\n\n    if (data.rows.length == 0) {\n      setSales(prepSales({\n        firstDay: \"\",\n        lastDay: \"\",\n        rows: [{\n          sales: 0,\n          day: date,\n          profit: 0,\n          product_id: \"\"\n        }]\n      }));\n    } else {\n      data[\"firstDay\"] = date;\n      data[\"lastDay\"] = prevDate;\n      setSales(prepSales(data));\n    }\n  }\n\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center py-4\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 203,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"h2\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 204,\n      columnNumber: 9\n    }\n  }, \" Stream Alerts\"), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"d-flex ms-auto\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 206,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Button, {\n    id: \"1\",\n    variant: \"secondary\",\n    size: \"sm\",\n    className: \"me-2\",\n    onClick: overviewToday,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 207,\n      columnNumber: 13\n    }\n  }, \"Save\"), /*#__PURE__*/React.createElement(Button, {\n    id: \"2\",\n    variant: \"secondary\",\n    size: \"sm\",\n    className: \"me-2\",\n    onClick: overviewWeek,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 208,\n      columnNumber: 13\n    }\n  }, \"Test\"))), /*#__PURE__*/React.createElement(Row, {\n    className: \"justify-content-md-center\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 212,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(Col, {\n    xs: 12,\n    sm: 6,\n    xl: 4,\n    className: \"mb-4\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 214,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(CounterWidget, {\n    category: \"Profit\",\n    title: (parseInt(overview.profit) * user.rate).toFixed(2),\n    period: overview.date,\n    percentage: 28.4,\n    icon: faCashRegister,\n    iconColor: \"shape-tertiary\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 215,\n      columnNumber: 11\n    }\n  })), /*#__PURE__*/React.createElement(Col, {\n    xs: 12,\n    sm: 6,\n    xl: 4,\n    className: \"mb-4\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 225,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(CircleChartWidget, {\n    title: \"Products\",\n    data: overview.products,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 226,\n      columnNumber: 11\n    }\n  }))), /*#__PURE__*/React.createElement(Col, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 232,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Card, {\n    border: \"light\",\n    className: \"bg-white shadow-sm mb-4\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 233,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(Card.Body, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 234,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"h5\", {\n    className: \"mb-4\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 235,\n      columnNumber: 15\n    }\n  }, \"Alert Links\"), /*#__PURE__*/React.createElement(Form, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 236,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(Row, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 237,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(Col, {\n    md: 8,\n    className: \"mb-3\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 238,\n      columnNumber: 19\n    }\n  }, /*#__PURE__*/React.createElement(Form.Group, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 239,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(Form.Control, {\n    id: \"link\",\n    value: \"CreatorInvetory.com/alerts/\",\n    required: true,\n    type: \"text\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 240,\n      columnNumber: 23\n    }\n  }))), /*#__PURE__*/React.createElement(Col, {\n    md: 4,\n    className: \"mb-3\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 244,\n      columnNumber: 19\n    }\n  }, /*#__PURE__*/React.createElement(Button, {\n    variant: \"primary\",\n    type: \"button\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 245,\n      columnNumber: 21\n    }\n  }, \"Copy\"))))))), /*#__PURE__*/React.createElement(Row, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 252,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(Row, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 256,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(Col, {\n    xs: 12,\n    xl: 12,\n    className: \"mb-4\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 257,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Row, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 258,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(TransactionsTable, {\n    data: campaigns,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 259,\n      columnNumber: 13\n    }\n  })))));\n});\n\nfunction prepToday(data, productsNames) {\n  var products = {};\n  var tmp = {\n    \"sales\": 0,\n    \"profit\": 0,\n    \"products\": [],\n    \"date\": data.rows[0].day.substring(0, 10)\n  };\n\n  for (var i = 0; i < data.rows.length; i++) {\n    tmp[\"sales\"] = tmp[\"sales\"] + data.rows[i].sales;\n    tmp[\"profit\"] = tmp[\"profit\"] + data.rows[i].profit;\n\n    if (products[data.rows[i].product_id] == undefined) {\n      products[data.rows[i].product_id] = data.rows[i].sales;\n    } else {\n      products[data.rows[i].product_id] = data.rows[i].sales + products[data.rows[i].product_id];\n    }\n  }\n\n  var i = 0;\n\n  for (const product in products) {\n    tmp.products.push({\n      \"id\": i + 1,\n      \"label\": productsNames[product],\n      \"value\": products[product]\n    });\n    i = i + 1;\n  }\n\n  return tmp;\n}\n\nfunction prepSales(data) {\n  var tmp = {\n    \"total\": 0,\n    \"days\": {\n      \"labels\": [],\n      \"series\": []\n    }\n  };\n  var days = {}; //Create days data structure\n\n  if (data.firstDay != \"\") {\n    var start = new Date(data.firstDay);\n    start.setDate(start.getDate() + 1);\n    var end = new Date(data.lastDay);\n    end.setDate(end.getDate() + 1);\n    var loop = new Date(start);\n\n    while (loop <= end) {\n      var date = formatDate(loop);\n      date = date.substring(5, 7) + \"/\" + date.substring(8, 10);\n      days[date] = 0;\n      var newDate = loop.setDate(loop.getDate() + 1);\n      loop = new Date(newDate);\n    }\n  } //fill in dates\n\n\n  for (var i = 0; i < data.rows.length; i++) {\n    tmp.total = tmp.total + data.rows[i].profit;\n    var date = data.rows[i].day.substring(5, 7) + \"/\" + data.rows[i].day.substring(8, 10);\n\n    if (days[date] == undefined) {\n      days[date] = data.rows[i].sales;\n    } else {\n      days[date] = days[date] + data.rows[i].sales;\n    }\n  }\n\n  var series = [];\n\n  for (const day in days) {\n    tmp.days.labels.push(day);\n    series.push(days[day]);\n  }\n\n  tmp.days.series.push(series);\n  return tmp;\n}\n\nfunction prepCampaigns(data, rate) {\n  var tmp = [];\n\n  for (var i = 0; i < data.rows.length; i++) {\n    var row = {\n      \"products\": data.rows[i].img_url,\n      \"day\": data.rows[i].start_date.substring(0, 10),\n      \"sales\": data.rows[i].sales,\n      \"profit\": (data.rows[i].profit * rate).toFixed(2)\n    };\n    tmp.push(row);\n  }\n\n  return tmp;\n}\n\nfunction getProductNames(data) {\n  var tmp = {};\n\n  for (var i = 0; i < data.rows.length; i++) {\n    tmp[data.rows[i].product_id] = data.rows[i].short_name;\n  }\n\n  return tmp;\n}\n\nasync function queryDB(start, end, q, id) {\n  //Building API Call\n  var url = \"https://d7rc7vsgld.execute-api.us-west-2.amazonaws.com/dev/q?id=\" + id;\n\n  if (q != \"\") {\n    url += \"&q=\" + q;\n  }\n\n  if (start != \"\") {\n    url += \"&start=\" + start;\n  }\n\n  if (end != \"\") {\n    url += \"&end=\" + end;\n  } //Making Call\n\n\n  const Response = await new Promise((resolve, reject) => {\n    var req = fetch(url, {\n      method: 'GET',\n      // *GET, POST, PUT, DELETE, etc.\n      mode: 'cors',\n      // no-cors, *cors, same-origin\n      cache: 'no-cache',\n      // *default, no-cache, reload, force-cache, only-if-cached\n      credentials: 'same-origin',\n      // include, *same-origin, omit\n      headers: {\n        'Content-Type': 'text/plain' // 'Content-Type': 'application/x-www-form-urlencoded',\n\n      },\n      redirect: 'follow',\n      // manual, *follow, error\n      referrerPolicy: 'no-referrer' // no-referrer, *no-referrer-when-downgrade, origin, origin-when-cross-origin, same-origin, strict-origin, strict-origin-when-cross-origin, unsafe-url\n\n    });\n    req.then(result => {\n      var res = result.json();\n      res.then(tmp => {\n        resolve({\n          statusCode: 200,\n          body: JSON.stringify(tmp, null, 4)\n        });\n      });\n    });\n  });\n  var tmp = JSON.parse(Response.body);\n  return tmp;\n}\n\nfunction formatDate(day) {\n  if (day.getMonth() < 9) {\n    var date = day.getFullYear() + '-0' + (day.getMonth() + 1);\n  } else {\n    var date = day.getFullYear() + '-' + (day.getMonth() + 1);\n  }\n\n  if (day.getDate() < 9) {\n    date = date + '-0' + day.getDate();\n  } else {\n    date = date + '-' + day.getDate();\n  }\n\n  return date;\n}","map":{"version":3,"sources":["/Users/johncomonitski/Programming Projects/Dashboard2/Dashboard/src/pages/StreamAlerts.js"],"names":["React","useState","useEffect","useContext","faCashRegister","faChartLine","Col","Row","Card","Form","Button","Dropdown","ButtonGroup","InputGroup","CounterWidget","CircleChartWidget","BarChartWidget","ProductsWidget","ProgressTrackWidget","RankingWidget","SalesValueWidget","SalesValueWidgetPhone","AcquisitionWidget","PageVisitsTable","TransactionsTable","UserContext","props","emptyPackage","today","rows","sales","day","profit","product_id","firstDay","lastDay","total","campaigns","products","user","setUser","overview","setOverview","setSales","setCampaigns","productsNames","setProductsNames","data","Promise","resolve","reject","req","queryDB","history","location","state","then","result","statusCode","body","JSON","stringify","logInPackage","parse","id","name","client","yt_name","img","logo","rate","settings","getProductNames","prepToday","substring","length","prepSales","prepCampaigns","document","getElementById","addEventListener","salesWeek","salesMonth","overviewToday","classname","className","replace","Date","date","formatDate","console","log","overviewWeek","setDate","getDate","prevDate","overviewMonth","getFullYear","getMonth","parseInt","toFixed","tmp","i","undefined","product","push","days","start","end","loop","newDate","series","labels","row","img_url","start_date","short_name","q","url","Response","fetch","method","mode","cache","credentials","headers","redirect","referrerPolicy","res","json"],"mappings":"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","sourcesContent":["\nimport React, { useState, useEffect, useContext } from 'react';\nimport { faCashRegister, faChartLine } from '@fortawesome/free-solid-svg-icons';\nimport { Col, Row, Card, Form, Button, Dropdown, ButtonGroup, InputGroup } from '@themesberg/react-bootstrap';\n\nimport { CounterWidget, CircleChartWidget, BarChartWidget, ProductsWidget, ProgressTrackWidget, RankingWidget, SalesValueWidget, SalesValueWidgetPhone, AcquisitionWidget } from \"../components/Widgets\";\nimport { PageVisitsTable, TransactionsTable } from \"../components/Tables\";\n\nimport { UserContext } from \"./UserContext\";\n\nexport default (props) => {\n\n  const emptyPackage = {\n    today: {rows:[{sales:0, day:\"\", profit:0, product_id:\"\"}]},\n    sales: {firstDay: \"\", lastDay: \"\", total: 0,rows:[{sales:0, day:\"\", profit:0, product_id:\"\"},{sales:0, day:\"\", profit:0, product_id:\"\"}]},\n    campaigns: [[]],\n    products:{}\n  }\n\n  //User\n  const {user, setUser} = useContext(UserContext);\n  //UI Widgets\n  const [overview, setOverview] = useState(emptyPackage.today);\n  const [sales, setSales] = useState(emptyPackage.sales);\n  const [campaigns, setCampaigns] = useState(emptyPackage.campaigns);\n  const [productsNames, setProductsNames] = useState(emptyPackage.products);\n\n  useEffect(() => {\n    (async () => {\n      //Setting log in Package\n      var data = await new Promise((resolve, reject) => {\n        var req = queryDB(\"2020-09-10\", \"2020-09-16\", \"login\", props.history.location.state);\n        req.then((result) => {\n          resolve({\n            statusCode: 200,\n            body: JSON.stringify(result, null, 4)\n          });\n        });\n      });\n      //Setting up user\n      var logInPackage = JSON.parse(data.body)\n      setUser({id:props.history.location.state, name:logInPackage.client.rows[0].yt_name, img: logInPackage.client.rows[0].logo, rate: logInPackage.client.rows[0].rate, settings:logInPackage.client.rows[0]})\n      //Setting up UI\n      setProductsNames(getProductNames(logInPackage.campaigns))\n      setOverview(prepToday(logInPackage.today, productsNames));\n      logInPackage.sales[\"firstDay\"] = logInPackage.sales.rows[0].day.substring(0,10);\n      logInPackage.sales[\"lastDay\"] = logInPackage.sales.rows[logInPackage.sales.rows.length - 1].day.substring(0,10);\n      setSales(prepSales(logInPackage.sales));\n      setCampaigns(prepCampaigns(logInPackage.campaigns,logInPackage.client.rows[0].rate));\n\n      //Setting up Sales Widget Controls\n      document.getElementById(\"4\").addEventListener(\"click\", salesWeek);\n      document.getElementById(\"5\").addEventListener(\"click\", salesMonth);\n\n    })()\n  },[])\n\n  //Button Events\n  async function overviewToday(){\n    //change color\n    var classname = document.getElementById(\"1\").className;\n    classname = classname.replace(\"btn-secondary\",\"btn-primary\");\n    document.getElementById(\"1\").className = classname;\n\n    classname = document.getElementById(\"2\").className;\n    classname = classname.replace(\"btn-primary\",\"btn-secondary\");\n    document.getElementById(\"2\").className = classname;\n\n    classname = document.getElementById(\"3\").className;\n    classname = classname.replace(\"btn-primary\",\"btn-secondary\");\n    document.getElementById(\"3\").className = classname;\n\n    //Getting today\n    var today = new Date();\n    var date = formatDate(today);\n\n    var data = await queryDB(date, \"\", \"sales\", user.id);\n    console.log(\"hi\")\n    if(data.rows.length == 0){\n      console.log(\"poop\")\n      setOverview(prepToday({rows:[{sales:0, day:date, profit:0, product_id:\"\"}]}, {}));\n    }\n    else{\n      console.log(\"tits\")\n      setOverview(prepToday(data, productsNames))\n    }\n  }\n  async function overviewWeek(){\n    //change color\n    var classname = document.getElementById(\"1\").className;\n    classname = classname.replace(\"btn-primary\",\"btn-secondary\");\n    document.getElementById(\"1\").className = classname;\n\n    classname = document.getElementById(\"2\").className;\n    classname = classname.replace(\"btn-secondary\",\"btn-primary\");\n    document.getElementById(\"2\").className = classname;\n\n    classname = document.getElementById(\"3\").className;\n    classname = classname.replace(\"btn-primary\",\"btn-secondary\");\n    document.getElementById(\"3\").className = classname;\n\n    //Getting today\n    var today = new Date();\n    var date = formatDate(today);\n    today.setDate(today.getDate() - 6)\n    var prevDate = formatDate(today);\n\n    var data = await queryDB(prevDate, date, \"sales\", user.id);\n    if(data.rows.length == 0){\n      setOverview(prepToday({rows:[{sales:0, day:date, profit:0, product_id:\"\"}]},{}));\n    }\n    else{\n      setOverview(prepToday(data, productsNames))\n    }\n  }\n  async function overviewMonth(){\n    //change color\n    var classname = document.getElementById(\"1\").className;\n    classname = classname.replace(\"btn-primary\",\"btn-secondary\");\n    document.getElementById(\"1\").className = classname;\n\n    classname = document.getElementById(\"2\").className;\n    classname = classname.replace(\"btn-primary\",\"btn-secondary\");\n    document.getElementById(\"2\").className = classname;\n\n    classname = document.getElementById(\"3\").className;\n    classname = classname.replace(\"btn-secondary\",\"btn-primary\");\n    document.getElementById(\"3\").className = classname;\n\n    //Getting today\n    var today = new Date();\n    var firstDay = new Date(today.getFullYear(), today.getMonth(), 1);\n    var lastDay = new Date(today.getFullYear(), today.getMonth() + 1, 0);\n    var date = formatDate(firstDay);\n    var prevDate = formatDate(lastDay);\n    console.log(date, prevDate);\n\n    var data = await queryDB(date, prevDate, \"sales\", user.id);\n    if(data.rows.length == 0){\n      setOverview(prepToday({rows:[{sales:0, day:date, profit:0, product_id:\"\"}]},{}));\n    }\n    else{\n      setOverview(prepToday(data, productsNames))\n    }\n  }\n  async function salesWeek(){\n    //change color\n    var classname = document.getElementById(\"4\").className;\n    classname = classname.replace(\"btn-secondary\",\"btn-primary\");\n    document.getElementById(\"4\").className = classname;\n\n    var classname = document.getElementById(\"5\").className;\n    classname = classname.replace(\"btn-primary\",\"btn-secondary\");\n    document.getElementById(\"5\").className = classname;\n\n    //Getting today\n    var today = new Date();\n    var date = formatDate(today);\n    today.setDate(today.getDate() - 6)\n    var prevDate = formatDate(today);\n\n    var data = await queryDB(prevDate, date, \"sales\", user.id);\n    console.log(data)\n    if(data.rows.length == 0){\n      setSales(prepSales({firstDay:\"\", lastDay:\"\", rows:[{sales:0, day:date, profit:0, product_id:\"\"}]}));\n    }\n    else{\n      data[\"firstDay\"] = prevDate;\n      data[\"lastDay\"] = date;\n      setSales(prepSales(data))\n    }\n  }\n  async function salesMonth(){\n    //change color\n    var classname = document.getElementById(\"4\").className;\n    classname = classname.replace(\"btn-primary\",\"btn-secondary\");\n    document.getElementById(\"4\").className = classname;\n\n    var classname = document.getElementById(\"5\").className;\n    classname = classname.replace(\"btn-secondary\",\"btn-primary\");\n    document.getElementById(\"5\").className = classname;\n\n    //Getting today\n    var today = new Date();\n    var firstDay = new Date(today.getFullYear(), today.getMonth(), 1);\n    var lastDay = new Date(today.getFullYear(), today.getMonth() + 1, 0);\n    var date = formatDate(firstDay);\n    var prevDate = formatDate(lastDay);\n\n    var data = await queryDB(date, prevDate, \"sales\", user.id);\n    if(data.rows.length == 0){\n      setSales(prepSales({firstDay:\"\", lastDay:\"\", rows:[{sales:0, day:date, profit:0, product_id:\"\"}]}));\n    }\n    else{\n      data[\"firstDay\"] = date;\n      data[\"lastDay\"] = prevDate;\n      setSales(prepSales(data))\n    }\n  }\n\n  return (\n    <>\n      <div className=\"d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center py-4\">\n        <h2> Stream Alerts</h2>\n\n        <div className=\"d-flex ms-auto\">\n            <Button id=\"1\" variant=\"secondary\" size=\"sm\" className=\"me-2\" onClick={overviewToday}>Save</Button>\n            <Button id=\"2\" variant=\"secondary\" size=\"sm\" className=\"me-2\" onClick={overviewWeek}>Test</Button>\n        </div>\n      </div>\n\n      <Row className=\"justify-content-md-center\">\n\n        <Col xs={12} sm={6} xl={4} className=\"mb-4\">\n          <CounterWidget\n            category=\"Profit\"\n            title={(parseInt(overview.profit) * user.rate).toFixed(2)}\n            period={overview.date}\n            percentage={28.4}\n            icon={faCashRegister}\n            iconColor=\"shape-tertiary\"\n          />\n        </Col>\n\n        <Col xs={12} sm={6} xl={4} className=\"mb-4\">\n          <CircleChartWidget\n            title=\"Products\"\n            data={overview.products} />\n        </Col>\n\n      </Row>\n        <Col >\n          <Card border=\"light\" className=\"bg-white shadow-sm mb-4\">\n            <Card.Body>\n              <h5 className=\"mb-4\">Alert Links</h5>\n              <Form>\n                <Row>\n                  <Col md={8} className=\"mb-3\">\n                    <Form.Group >\n                      <Form.Control id=\"link\" value={\"CreatorInvetory.com/alerts/\"} required type=\"text\" />\n                    </Form.Group>\n\n                  </Col>\n                  <Col md={4} className=\"mb-3\">\n                    <Button variant=\"primary\" type=\"button\" >Copy</Button>\n                  </Col>\n                </Row>\n              </Form>\n            </Card.Body>\n          </Card>\n        </Col>\n      <Row>\n\n      </Row>\n\n      <Row>\n        <Col xs={12} xl={12} className=\"mb-4\">\n          <Row>\n            <TransactionsTable data={campaigns} />\n          </Row>\n        </Col>\n      </Row>\n    </>\n  );\n};\n\nfunction prepToday(data, productsNames){\n  var products = {};\n  var tmp = {\"sales\": 0, \"profit\": 0, \"products\":[],\"date\":data.rows[0].day.substring(0,10)};\n  for(var i = 0; i < data.rows.length; i++){\n    tmp[\"sales\"] = tmp[\"sales\"] + data.rows[i].sales;\n    tmp[\"profit\"] = tmp[\"profit\"] + data.rows[i].profit;\n\n    if(products[data.rows[i].product_id]==undefined){\n      products[data.rows[i].product_id] = data.rows[i].sales;\n    }\n    else{\n      products[data.rows[i].product_id] = data.rows[i].sales + products[data.rows[i].product_id];\n    }\n  }\n\n  var i = 0;\n  for(const product in products){\n    tmp.products.push({\"id\": i+1, \"label\": productsNames[product], \"value\": products[product]})\n    i = i+1;\n  }\n  return tmp;\n}\n\nfunction prepSales(data){\n  var tmp = {\"total\": 0, \"days\": {\"labels\" :[], \"series\": []}};\n  var days = {};\n\n  //Create days data structure\n  if(data.firstDay != \"\"){\n    var start = new Date(data.firstDay);\n    start.setDate(start.getDate() +1);\n    var end = new Date(data.lastDay);\n    end.setDate(end.getDate() +1);\n\n    var loop = new Date(start);\n    while(loop <= end){\n       var date = formatDate(loop);\n       date = date.substring(5,7) + \"/\" + date.substring(8,10)\n       days[date] = 0;\n       var newDate = loop.setDate(loop.getDate() + 1);\n       loop = new Date(newDate);\n    }\n  }\n\n  //fill in dates\n  for(var i = 0; i < data.rows.length; i++){\n    tmp.total = tmp.total + data.rows[i].profit\n    var date = data.rows[i].day.substring(5,7) + \"/\" + data.rows[i].day.substring(8,10);\n    if(days[date] == undefined){\n      days[date] = data.rows[i].sales;\n    }\n    else{\n      days[date] = days[date] + data.rows[i].sales;\n    }\n  }\n\n  var series = [];\n  for(const day in days){\n    tmp.days.labels.push(day);\n    series.push(days[day]);\n  }\n  tmp.days.series.push(series);\n  return tmp;\n}\n\nfunction prepCampaigns(data, rate){\n  var tmp = [];\n  for(var i = 0; i < data.rows.length; i++){\n    var row = {\"products\": data.rows[i].img_url, \"day\": data.rows[i].start_date.substring(0,10), \"sales\": data.rows[i].sales, \"profit\": (data.rows[i].profit * rate).toFixed(2)};\n    tmp.push(row);\n  }\n\n  return tmp;\n}\n\nfunction getProductNames(data){\n  var tmp = {}\n  for(var i = 0; i < data.rows.length; i++){\n    tmp[data.rows[i].product_id] = data.rows[i].short_name\n  }\n  return tmp;\n}\n\nasync function queryDB(start, end, q, id){\n    //Building API Call\n    var url = \"https://d7rc7vsgld.execute-api.us-west-2.amazonaws.com/dev/q?id=\" + id;\n    if(q != \"\"){\n      url += \"&q=\"+q\n    }\n    if(start != \"\"){\n      url += \"&start=\"+start\n    }\n    if(end != \"\"){\n      url += \"&end=\"+end\n    }\n\n    //Making Call\n    const Response = await new Promise((resolve, reject) => {\n  \tvar req = fetch(url, {\n  \t\tmethod: 'GET', // *GET, POST, PUT, DELETE, etc.\n  \t\tmode: 'cors', // no-cors, *cors, same-origin\n  \t\tcache: 'no-cache', // *default, no-cache, reload, force-cache, only-if-cached\n  \t\tcredentials: 'same-origin', // include, *same-origin, omit\n  \t\theaders: {\n  \t\t  'Content-Type': 'text/plain',\n  \t\t  // 'Content-Type': 'application/x-www-form-urlencoded',\n  \t\t},\n  \t\tredirect: 'follow', // manual, *follow, error\n  \t\treferrerPolicy: 'no-referrer' // no-referrer, *no-referrer-when-downgrade, origin, origin-when-cross-origin, same-origin, strict-origin, strict-origin-when-cross-origin, unsafe-url\n  \t});\n  \treq.then((result) => {\n  \t    var res = result.json()\n  \t    res.then((tmp) => {\n  \t        resolve({\n      \t\t    statusCode: 200,\n      \t\t    body: JSON.stringify(tmp, null, 4)\n      \t    });\n  \t    });\n  \t});\n    });\n    var tmp = (JSON.parse(Response.body));\n    return tmp;\n}\n\nfunction formatDate(day){\n  if(day.getMonth() < 9){\n    var date = day.getFullYear()+'-0'+(day.getMonth()+1)\n  }\n  else{\n    var date = day.getFullYear()+'-'+(day.getMonth()+1)\n  }\n  if(day.getDate() < 9){\n    date = date +'-0'+day.getDate();\n  }\n  else{\n    date = date +'-'+day.getDate();\n  }\n\n  return date;\n}\n"]},"metadata":{},"sourceType":"module"}